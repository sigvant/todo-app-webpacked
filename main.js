(()=>{"use strict";function t(t){this.name=t,this.todos=[]}function e(t,e,n,d){this.name=t,this.date=e,this.priority=n,this.status=d}const n={todoInput:document.querySelector(".todo-input"),todoDateInput:document.querySelector(".todo-date-input"),todoPriorityInput:document.querySelector(".priority-select"),todoButton:document.querySelector(".todo-button"),todoList:document.querySelector(".todo-list"),filterOption:document.querySelector(".filter-todo"),addTabButton:document.querySelector(".tab-button"),tabList:document.querySelector(".tab-list"),tab:document.querySelectorAll(".tab")};let d;function o(){s();let t=document.querySelector(".tab-active").children[0].children[0].innerText;d.forEach((e=>{e.name==t&&e.todos.forEach((t=>{const e=document.createElement("div");e.classList.add("todo");let d=t.name,o=t.date,a=t.priority;const s=document.createElement("li");s.classList.add("todo-item");const i=document.createElement("div");i.textContent=d,i.classList.add("todo-info-boxes-name");const c=document.createElement("div");c.textContent=o,c.classList.add("todo-info-boxes-date");const l=document.createElement("div");l.textContent=a,l.classList.add("todo-info-boxes-priority"),s.appendChild(i),s.appendChild(c),s.appendChild(l),e.appendChild(s);const r=document.createElement("button");r.textContent="‚úîÔ∏è",r.classList.add("complete-btn"),e.appendChild(r);const u=document.createElement("button");u.textContent="üóëÔ∏è",u.classList.add("trash-btn"),e.appendChild(u),n.todoList.appendChild(e)}))}))}function a(){void 0!==n.tabList.childNodes[0]&&(n.tabList.childNodes[0].classList.add("tab-active"),o())}function s(){return d=null===localStorage.getItem("tabs")?[]:JSON.parse(localStorage.getItem("tabs")),d}document.addEventListener("DOMContentLoaded",(function(){s(),d.forEach((function(t){let e=t.name,d=document.createElement("li");d.classList.add("tab");let o=document.createElement("div");o.classList.add("tab-div");let a=document.createElement("div");a.classList.add("span-div");let s=document.createElement("span");s.textContent=e;let i=document.createElement("div");i.classList.add("trashcan-div");let c=document.createElement("button");c.classList.add("trash-btn"),c.textContent="üóëÔ∏è",a.appendChild(s),o.appendChild(a),i.appendChild(c),d.appendChild(o),d.appendChild(i),n.tabList.appendChild(d)}))})),document.addEventListener("DOMContentLoaded",a),document.addEventListener("DOMContentLoaded",(function(){let t=new Date,e=t.getDate(),n=t.getMonth()+1;n<10&&(n=`0${n}`);let d=`${t.getFullYear()}-${n}-${e}`;document.querySelector(".todo-date-input").setAttribute("min",d)})),n.todoButton.addEventListener("click",(function(t){t.preventDefault();const o=document.createElement("div");o.classList.add("todo");let a=n.todoInput.value,i=n.todoDateInput.value,c=n.todoPriorityInput.value,l=new e(a,i,c);const r=document.createElement("li");r.classList.add("todo-item");const u=document.createElement("div");u.textContent=a,u.classList.add("todo-info-boxes-name");const m=document.createElement("div");m.textContent=i,m.classList.add("todo-info-boxes-date");const p=document.createElement("div");p.textContent=c,p.classList.add("todo-info-boxes-priority"),r.appendChild(u),r.appendChild(m),r.appendChild(p),o.appendChild(r),function(t){s();const e=document.querySelector(".tab-active").childNodes[0].innerText;d.forEach((n=>{n.name==e&&(n.todos.push(t),localStorage.setItem("tabs",JSON.stringify(d)))}))}(l);const L=document.createElement("button");L.textContent="‚úîÔ∏è",L.classList.add("complete-btn"),o.appendChild(L);const h=document.createElement("button");h.textContent="üóëÔ∏è",h.classList.add("trash-btn"),o.appendChild(h),n.todoList.appendChild(o),n.todoInput.value="",n.todoDateInput.value=""})),n.todoList.addEventListener("click",(function(t){const e=t.target;if("trash-btn"===e.classList[0]){const t=e.parentElement;t.classList.add("fall"),function(t){const e=t.childNodes[0].childNodes[0].innerText;s(),d.forEach((t=>{t.todos=t.todos.filter((t=>t.name!=e))})),localStorage.setItem("tabs",JSON.stringify(d))}(t),t.addEventListener("transitionend",(()=>{t.remove()}))}"complete-btn"===e.classList[0]&&e.parentElement.classList.toggle("completed")})),n.filterOption.addEventListener("click",(function(t){n.todoList.childNodes.forEach((function(e){switch(t.target.value){case"all":e.style.display="flex";break;case"completed":e.classList.contains("completed")?e.style.display="flex":e.style.display="none";break;case"uncompleted":e.classList.contains("completed")?e.style.display="none":e.style.display="flex"}}))})),n.addTabButton.addEventListener("click",(function(e){e.preventDefault();let o=new t(prompt("Name your tab!","Popsicle")),i=document.createElement("li");i.classList.add("tab");let c=document.createElement("div");c.classList.add("tab-div");let l=document.createElement("div");l.classList.add("span-div");let r=document.createElement("span");r.textContent=o.name;let u=document.createElement("div");u.classList.add("trashcan-div");let m=document.createElement("button");m.classList.add("trash-btn-tab"),m.textContent="üóëÔ∏è",function(t){s(),d.push(t),localStorage.setItem("tabs",JSON.stringify(d))}(o),l.appendChild(r),c.appendChild(l),u.appendChild(m),i.appendChild(c),i.appendChild(u),n.tabList.appendChild(i),a()})),n.tabList.addEventListener("click",(function(t){const e=t.target;if("trash-btn-tab"===e.classList[0]||"trash-btn"===e.classList[0]){const t=e.parentElement.parentElement;if(1===t.parentElement.childNodes.length)return;t.classList.add("fall"),function(t){s();const e=t.children[0].innerText;d.splice(d.indexOf(e),1),localStorage.setItem("tabs",JSON.stringify(d))}(t),t.addEventListener("transitionend",(()=>{t.remove()}))}if("tab-div"===e.classList[0]||"tab"===e.classList[0]||"span-div"===e.classList[0]){let n=document.querySelectorAll(".tab");t.target.classList.contains("tab")&&(n.forEach((t=>t.classList.remove("tab-active"))),e.classList.add("tab-active"),document.querySelector(".todo-list").innerText="",o())}}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixFQUFPWCxZQUFZWSxHQUNuQkUsRUFBZWQsWUFBWWUsR0FDM0JMLEVBQU9WLFlBQVlXLEdBQ25CRCxFQUFPVixZQUFZYyxHQUNuQixzQkFBOEJKLEdBRTlCUCxPQXJPSiwyQkFBbUMsU0F5T25DLFNBQXlCc0IsR0FFckIsTUFBTVEsRUFBT1IsRUFBTVMsT0FJbkIsR0FBeUIsa0JBQXRCRCxFQUFLeEMsVUFBVSxJQUFnRCxjQUF0QndDLEVBQUt4QyxVQUFVLEdBQXFCLENBQzVFLE1BQU1aLEVBQU1vRCxFQUFLRSxjQUFjQSxjQUUvQixHQUEyQyxJQUF4Q3RELEVBQUlzRCxjQUFjUCxXQUFXbUIsT0FBYyxPQUU5Q2xFLEVBQUlZLFVBQVVDLElBQUksUUEwRDFCLFNBQXdCYixHQUNwQkksSUFHQSxNQUFNK0QsRUFBV25FLEVBQUlNLFNBQVMsR0FBR0MsVUFDakNMLEVBQUtrRSxPQUFPbEUsRUFBS21FLFFBQVFGLEdBQVcsR0FDcEMzQyxhQUFheUIsUUFBUSxPQUFRdkIsS0FBS3dCLFVBQVVoRCxJQS9EeENvRSxDQUFldEUsR0FDZkEsRUFBSTRCLGlCQUFpQixpQkFBaUIsS0FDbEM1QixFQUFJMEQsWUFNWixHQUF5QixZQUF0Qk4sRUFBS3hDLFVBQVUsSUFBMEMsUUFBdEJ3QyxFQUFLeEMsVUFBVSxJQUFzQyxhQUF0QndDLEVBQUt4QyxVQUFVLEdBQW1CLENBQ25HLElBQUlaLEVBQU1ULFNBQVNVLGlCQUFpQixRQUNqQzJDLEVBQU1TLE9BQU96QyxVQUFVbUQsU0FBUyxTQUMvQi9ELEVBQUlRLFNBQVE0QyxHQUFRQSxFQUFLeEMsVUFBVThDLE9BQU8sZ0JBQzFDTixFQUFLeEMsVUFBVUMsSUFBSSxjQWlFM0J0QixTQUFTQyxjQUFjLGNBQWNlLFVBQVksR0EvRHpDSixVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1hcHAtd2VicGFja2VkLy4vc3JjL2NvbnN0cnVjdG9ycy5qcyIsIndlYnBhY2s6Ly90b2RvLWFwcC13ZWJwYWNrZWQvLi9zcmMvc2VsZWN0b3JzLmpzIiwid2VicGFjazovL3RvZG8tYXBwLXdlYnBhY2tlZC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBUYWIobmFtZSkge1xyXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIHRoaXMudG9kb3MgPSBbXTtcclxufVxyXG5cclxuZnVuY3Rpb24gVG9kbyhuYW1lLCBkYXRlLCBwcmlvcml0eSwgc3RhdHVzKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lXHJcbiAgICB0aGlzLmRhdGUgPSBkYXRlXHJcbiAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHlcclxuICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzO1xyXG59XHJcblxyXG5leHBvcnQge1RhYiwgVG9kb30iLCJjb25zdCBzZWxlY3RvcnMgPSAoKCkgPT4ge1xyXG4gICAgY29uc3QgdG9kb0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZG8taW5wdXQnKTtcclxuICAgIGNvbnN0IHRvZG9EYXRlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kby1kYXRlLWlucHV0Jyk7XHJcbiAgICBjb25zdCB0b2RvUHJpb3JpdHlJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmlvcml0eS1zZWxlY3QnKVxyXG4gICAgY29uc3QgdG9kb0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2RvLWJ1dHRvbicpO1xyXG4gICAgY29uc3QgdG9kb0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kby1saXN0Jyk7XHJcbiAgICBjb25zdCBmaWx0ZXJPcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmlsdGVyLXRvZG8nKTtcclxuXHJcbiAgICAvL3NlbGVjdG9ycyB0YWIgYXJlYVxyXG4gICAgY29uc3QgYWRkVGFiQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYi1idXR0b24nKTtcclxuICAgIGNvbnN0IHRhYkxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFiLWxpc3QnKTtcclxuICAgIGNvbnN0IHRhYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWInKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdG9kb0lucHV0LFxyXG4gICAgICAgIHRvZG9EYXRlSW5wdXQsXHJcbiAgICAgICAgdG9kb1ByaW9yaXR5SW5wdXQsXHJcbiAgICAgICAgdG9kb0J1dHRvbixcclxuICAgICAgICB0b2RvTGlzdCxcclxuICAgICAgICBmaWx0ZXJPcHRpb24sXHJcbiAgICAgICAgYWRkVGFiQnV0dG9uLFxyXG4gICAgICAgIHRhYkxpc3QsXHJcbiAgICAgICAgdGFiXHJcbiAgICB9O1xyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgc2VsZWN0b3JzOyIsImltcG9ydCB7IFRhYiwgVG9kbyB9IGZyb20gXCIuL2NvbnN0cnVjdG9yc1wiO1xyXG5pbXBvcnQgc2VsZWN0b3JzIGZyb20gXCIuL3NlbGVjdG9yc1wiO1xyXG5sZXQgdGFicztcclxuXHJcbi8vZXZlbnQgbGlzdGVuZXJzXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBsb2FkVGFicyk7XHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBhY3RpdmF0ZVRhYik7XHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBnZXRUb2RheURhdGUpO1xyXG5zZWxlY3RvcnMudG9kb0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFkZFRvZG8pO1xyXG5zZWxlY3RvcnMudG9kb0xpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWxldGVDaGVjayk7XHJcbnNlbGVjdG9ycy5maWx0ZXJPcHRpb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmaWx0ZXJUb2RvKTtcclxuc2VsZWN0b3JzLmFkZFRhYkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNyZWF0ZVRhYik7XHJcbnNlbGVjdG9ycy50YWJMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlU2VsZWN0VGFiKTtcclxuXHJcbi8vZnVuY3Rpb25zXHJcbmZ1bmN0aW9uIGFkZFRvZG8oZXZlbnQpIHtcclxuICAgIC8vcHJldmVudCBmb3JtIGZyb20gc3VibWl0dGluZ1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIC8vIHRvZG8gRElWXHJcbiAgICBjb25zdCB0b2RvRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICB0b2RvRGl2LmNsYXNzTGlzdC5hZGQoJ3RvZG8nKTtcclxuICAgIC8vIGNyZWF0ZSBMSVxyXG5cclxuICAgIC8vIHRvZG8gb2JqZWN0IGluc3RhbnRpYXRpb25cclxuXHJcbiAgICBsZXQgbmFtZSA9IHNlbGVjdG9ycy50b2RvSW5wdXQudmFsdWU7XHJcbiAgICBsZXQgZGF0ZSA9IHNlbGVjdG9ycy50b2RvRGF0ZUlucHV0LnZhbHVlO1xyXG4gICAgbGV0IHByaW9yaXR5ID0gc2VsZWN0b3JzLnRvZG9Qcmlvcml0eUlucHV0LnZhbHVlO1xyXG4gICAgbGV0IG5ld3RvZG9vYmogPSBuZXcgVG9kbyhuYW1lLCBkYXRlLCBwcmlvcml0eSk7XHJcblxyXG5cclxuICAgIGNvbnN0IG5ld1RvZG8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgbmV3VG9kby5jbGFzc0xpc3QuYWRkKCd0b2RvLWl0ZW0nKTtcclxuXHJcbiAgICBjb25zdCBuZXdUb2RvTmFtZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgbmV3VG9kb05hbWVEaXYudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgbmV3VG9kb05hbWVEaXYuY2xhc3NMaXN0LmFkZCgndG9kby1pbmZvLWJveGVzLW5hbWUnKVxyXG5cclxuICAgIGNvbnN0IG5ld1RvZG9EYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBuZXdUb2RvRGF0ZURpdi50ZXh0Q29udGVudCA9IGRhdGU7XHJcbiAgICBuZXdUb2RvRGF0ZURpdi5jbGFzc0xpc3QuYWRkKCd0b2RvLWluZm8tYm94ZXMtZGF0ZScpXHJcblxyXG4gICAgY29uc3QgbmV3VG9kb1ByaW9yaXR5RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBuZXdUb2RvUHJpb3JpdHlEaXYudGV4dENvbnRlbnQgPSBwcmlvcml0eTtcclxuICAgIG5ld1RvZG9Qcmlvcml0eURpdi5jbGFzc0xpc3QuYWRkKCd0b2RvLWluZm8tYm94ZXMtcHJpb3JpdHknKVxyXG4gICAgXHJcbiAgICBcclxuICAgIG5ld1RvZG8uYXBwZW5kQ2hpbGQobmV3VG9kb05hbWVEaXYpO1xyXG4gICAgbmV3VG9kby5hcHBlbmRDaGlsZChuZXdUb2RvRGF0ZURpdik7XHJcbiAgICBuZXdUb2RvLmFwcGVuZENoaWxkKG5ld1RvZG9Qcmlvcml0eURpdik7XHJcblxyXG4gICAgdG9kb0Rpdi5hcHBlbmRDaGlsZChuZXdUb2RvKTtcclxuXHJcblxyXG4gICAgLy8gYWRkIHRvZG8gdG8gdGhlIGxvY2FsIHN0b3JhZ2VcclxuICAgIC8vIHNhdmVMb2NhbFRvZG9zKG5ld3RvZG9vYmopO1xyXG4gICAgLy8gQ0hFQ0sgTUFSSyBidXR0b25cclxuXHJcbiAgICAvL3B1dCB0b2RvIGluIHRoZSBhY3RpdmUgdGFiXHJcbiAgICBzYXZlVG9kb3NpblRhYihuZXd0b2Rvb2JqKTtcclxuXHJcbiAgICBjb25zdCBjb21wbGV0ZWRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgIGNvbXBsZXRlZEJ1dHRvbi50ZXh0Q29udGVudCA9ICfinJTvuI8nO1xyXG4gICAgY29tcGxldGVkQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlLWJ0bicpO1xyXG4gICAgdG9kb0Rpdi5hcHBlbmRDaGlsZChjb21wbGV0ZWRCdXR0b24pO1xyXG4gICAgXHJcbiAgICAvLyB0cmFzaCBNQVJLIGJ1dHRvblxyXG5cclxuICAgIGNvbnN0IHRyYXNoQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICB0cmFzaEJ1dHRvbi50ZXh0Q29udGVudCA9ICfwn5eR77iPJztcclxuICAgIHRyYXNoQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3RyYXNoLWJ0bicpO1xyXG4gICAgdG9kb0Rpdi5hcHBlbmRDaGlsZCh0cmFzaEJ1dHRvbik7XHJcblxyXG4gICAgLy8gYXBwZW5kIHRvIGxpc3RcclxuICAgIHNlbGVjdG9ycy50b2RvTGlzdC5hcHBlbmRDaGlsZCh0b2RvRGl2KTtcclxuICAgIC8vIGNsZWFyIHRvZG8gaW5wdXQgdmFsdWVcclxuICAgIHNlbGVjdG9ycy50b2RvSW5wdXQudmFsdWUgPSAnJztcclxuICAgIHNlbGVjdG9ycy50b2RvRGF0ZUlucHV0LnZhbHVlID0gJyc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNhdmVUb2Rvc2luVGFiKHRvZG8pIHtcclxuICAgIHJldHJpZXZlVGFic0Zyb21NZW1vcnkoKTsgXHJcbiAgICBjb25zdCBhY3RpdmVUYWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFiLWFjdGl2ZScpO1xyXG4gICAgY29uc3QgdGFiTmFtZSA9IGFjdGl2ZVRhYi5jaGlsZE5vZGVzWzBdLmlubmVyVGV4dDtcclxuICAgIHRhYnMuZm9yRWFjaCh0YWIgPT4ge1xyXG4gICAgICAgIGlmKHRhYi5uYW1lID09IHRhYk5hbWUpIHtcclxuICAgICAgICAgICAgdGFiLnRvZG9zLnB1c2godG9kbyk7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0YWJzJywgSlNPTi5zdHJpbmdpZnkodGFicykpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUNoZWNrKGV2ZW50KSB7XHJcbiAgICBjb25zdCBpdGVtID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgXHJcbiAgICAvLyBkZWxldGUgdG9kb1xyXG4gICAgaWYoaXRlbS5jbGFzc0xpc3RbMF0gPT09ICd0cmFzaC1idG4nKSB7XHJcbiAgICAgICAgY29uc3QgdG9kbyA9IGl0ZW0ucGFyZW50RWxlbWVudDtcclxuICAgICAgICAvLyBhbmltYXRpb25cclxuICAgICAgICB0b2RvLmNsYXNzTGlzdC5hZGQoJ2ZhbGwnKTtcclxuICAgICAgICByZW1vdmVMb2NhbFRvZG9zKHRvZG8pO1xyXG4gICAgICAgIHRvZG8uYWRkRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsICgpID0+IHtcclxuICAgICAgICAgICAgdG9kby5yZW1vdmUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBjaGVjayBtYXJrXHJcblxyXG4gICAgaWYoaXRlbS5jbGFzc0xpc3RbMF0gPT09ICdjb21wbGV0ZS1idG4nKSB7XHJcbiAgICAgICAgY29uc3QgdG9kbyA9IGl0ZW0ucGFyZW50RWxlbWVudDtcclxuICAgICAgICB0b2RvLmNsYXNzTGlzdC50b2dnbGUoJ2NvbXBsZXRlZCcpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBmaWx0ZXJUb2RvKGV2ZW50KSB7XHJcbiAgICBjb25zdCB0b2RvcyA9IHNlbGVjdG9ycy50b2RvTGlzdC5jaGlsZE5vZGVzO1xyXG4gICAgdG9kb3MuZm9yRWFjaChmdW5jdGlvbih0b2RvKSB7XHJcbiAgICAgICAgc3dpdGNoKGV2ZW50LnRhcmdldC52YWx1ZSkge1xyXG4gICAgICAgICAgICBjYXNlICdhbGwnOlxyXG4gICAgICAgICAgICAgICAgdG9kby5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2NvbXBsZXRlZCc6XHJcbiAgICAgICAgICAgICAgICBpZih0b2RvLmNsYXNzTGlzdC5jb250YWlucygnY29tcGxldGVkJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0b2RvLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvZG8uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd1bmNvbXBsZXRlZCc6XHJcbiAgICAgICAgICAgICAgICBpZighdG9kby5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbXBsZXRlZCcpKXtcclxuICAgICAgICAgICAgICAgICAgICB0b2RvLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvZG8uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRUb2RvcygpIHtcclxuICAgIHJldHJpZXZlVGFic0Zyb21NZW1vcnkoKTtcclxuICAgIFxyXG4gICAgbGV0IHRhYk5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFiLWFjdGl2ZScpLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmlubmVyVGV4dDtcclxuICAgIFxyXG4gICAgdGFicy5mb3JFYWNoKHRhYiA9PiB7XHJcbiAgICAgICAgaWYodGFiLm5hbWUgPT0gdGFiTmFtZSkge1xyXG4gICAgICAgICAgICB0YWIudG9kb3MuZm9yRWFjaCh0b2RvID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIHRvZG8gRElWXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0b2RvRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICB0b2RvRGl2LmNsYXNzTGlzdC5hZGQoJ3RvZG8nKTtcclxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBMSVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gdG9kbyBvYmplY3QgaW5zdGFudGlhdGlvblxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgbGV0IG5hbWUgPSB0b2RvLm5hbWU7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGF0ZSA9IHRvZG8uZGF0ZTtcclxuICAgICAgICAgICAgICAgIGxldCBwcmlvcml0eSA9IHRvZG8ucHJpb3JpdHk7ICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1RvZG8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgICAgICAgICAgICAgbmV3VG9kby5jbGFzc0xpc3QuYWRkKCd0b2RvLWl0ZW0nKTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1RvZG9OYW1lRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBuZXdUb2RvTmFtZURpdi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgICAgICAgICBuZXdUb2RvTmFtZURpdi5jbGFzc0xpc3QuYWRkKCd0b2RvLWluZm8tYm94ZXMtbmFtZScpXHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdUb2RvRGF0ZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgbmV3VG9kb0RhdGVEaXYudGV4dENvbnRlbnQgPSBkYXRlO1xyXG4gICAgICAgICAgICAgICAgbmV3VG9kb0RhdGVEaXYuY2xhc3NMaXN0LmFkZCgndG9kby1pbmZvLWJveGVzLWRhdGUnKVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VG9kb1ByaW9yaXR5RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBuZXdUb2RvUHJpb3JpdHlEaXYudGV4dENvbnRlbnQgPSBwcmlvcml0eTtcclxuICAgICAgICAgICAgICAgIG5ld1RvZG9Qcmlvcml0eURpdi5jbGFzc0xpc3QuYWRkKCd0b2RvLWluZm8tYm94ZXMtcHJpb3JpdHknKVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIG5ld1RvZG8uYXBwZW5kQ2hpbGQobmV3VG9kb05hbWVEaXYpO1xyXG4gICAgICAgICAgICAgICAgbmV3VG9kby5hcHBlbmRDaGlsZChuZXdUb2RvRGF0ZURpdik7XHJcbiAgICAgICAgICAgICAgICBuZXdUb2RvLmFwcGVuZENoaWxkKG5ld1RvZG9Qcmlvcml0eURpdik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB0b2RvRGl2LmFwcGVuZENoaWxkKG5ld1RvZG8pO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc3QgY29tcGxldGVkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWRCdXR0b24udGV4dENvbnRlbnQgPSAn4pyU77iPJztcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZS1idG4nKTtcclxuICAgICAgICAgICAgICAgIHRvZG9EaXYuYXBwZW5kQ2hpbGQoY29tcGxldGVkQnV0dG9uKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gdHJhc2ggTUFSSyBidXR0b25cclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRyYXNoQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgICAgICAgICAgICB0cmFzaEJ1dHRvbi50ZXh0Q29udGVudCA9ICfwn5eR77iPJztcclxuICAgICAgICAgICAgICAgIHRyYXNoQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3RyYXNoLWJ0bicpO1xyXG4gICAgICAgICAgICAgICAgdG9kb0Rpdi5hcHBlbmRDaGlsZCh0cmFzaEJ1dHRvbik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBhcHBlbmQgdG8gbGlzdFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0b3JzLnRvZG9MaXN0LmFwcGVuZENoaWxkKHRvZG9EaXYpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZUxvY2FsVG9kb3ModG9kbykge1xyXG4gICAgY29uc3QgdG9kb0ZvclRhYiA9IHRvZG8uY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzBdLmlubmVyVGV4dDtcclxuICAgIHJldHJpZXZlVGFic0Zyb21NZW1vcnkoKTtcclxuICAgIHRhYnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBpdGVtLnRvZG9zID0gaXRlbS50b2Rvcy5maWx0ZXIoaXRlbSA9PiBpdGVtLm5hbWUgIT0gdG9kb0ZvclRhYik7XHJcbiAgICB9KVxyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RhYnMnLCBKU09OLnN0cmluZ2lmeSh0YWJzKSk7XHJcblxyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlVGFiKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAgIFxyXG4gICAgXHJcbiAgICBsZXQgbmFtZSA9IHByb21wdCgnTmFtZSB5b3VyIHRhYiEnLCAnUG9wc2ljbGUnKTtcclxuICAgIGxldCB0YWIgPSBuZXcgVGFiKG5hbWUpO1xyXG5cclxuICAgIGxldCBuZXdUYWIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgbmV3VGFiLmNsYXNzTGlzdC5hZGQoJ3RhYicpO1xyXG4gICAgbGV0IG5ld0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgbmV3RGl2LmNsYXNzTGlzdC5hZGQoJ3RhYi1kaXYnKTtcclxuICAgIGxldCBuZXdTcGFuRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBuZXdTcGFuRGl2LmNsYXNzTGlzdC5hZGQoJ3NwYW4tZGl2Jyk7XHJcbiAgICBsZXQgbmV3U3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgIG5ld1NwYW4udGV4dENvbnRlbnQgPSB0YWIubmFtZTtcclxuXHJcbiAgICBsZXQgbmV3VHJhc2hjYW5EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIG5ld1RyYXNoY2FuRGl2LmNsYXNzTGlzdC5hZGQoJ3RyYXNoY2FuLWRpdicpXHJcbiAgICBsZXQgbmV3VHJhc2hCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgIG5ld1RyYXNoQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3RyYXNoLWJ0bi10YWInKTtcclxuICAgIG5ld1RyYXNoQnV0dG9uLnRleHRDb250ZW50ID0gJ/Cfl5HvuI8nO1xyXG5cclxuICAgIC8vc2F2ZSB0YWIgdG8gbG9jYWwgbWVtb3J5XHJcbiAgICBzYXZlTG9jYWxUYWIodGFiKTtcclxuICAgIFxyXG4gICAgbmV3U3BhbkRpdi5hcHBlbmRDaGlsZChuZXdTcGFuKTtcclxuICAgIG5ld0Rpdi5hcHBlbmRDaGlsZChuZXdTcGFuRGl2KTtcclxuICAgIG5ld1RyYXNoY2FuRGl2LmFwcGVuZENoaWxkKG5ld1RyYXNoQnV0dG9uKTtcclxuICAgIG5ld1RhYi5hcHBlbmRDaGlsZChuZXdEaXYpO1xyXG4gICAgbmV3VGFiLmFwcGVuZENoaWxkKG5ld1RyYXNoY2FuRGl2KTtcclxuICAgIHNlbGVjdG9ycy50YWJMaXN0LmFwcGVuZENoaWxkKG5ld1RhYik7ICAgXHJcbiAgICBcclxuICAgIGFjdGl2YXRlVGFiKCk7XHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiBkZWxldGVTZWxlY3RUYWIoZXZlbnQpIHsgXHJcbiAgICBcclxuICAgIGNvbnN0IGl0ZW0gPSBldmVudC50YXJnZXQ7XHJcbiAgICBcclxuICAgIFxyXG4gICAgLy8gZGVsZXRlIHRvZG9cclxuICAgIGlmKGl0ZW0uY2xhc3NMaXN0WzBdID09PSAndHJhc2gtYnRuLXRhYicgfHwgaXRlbS5jbGFzc0xpc3RbMF0gPT09ICd0cmFzaC1idG4nICkge1xyXG4gICAgICAgIGNvbnN0IHRhYiA9IGl0ZW0ucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgIC8vIGRvZXMgbm90IGFsbG93IGRlbGV0aW9uIHdoZW4gb25seSBvbmUgdGFiXHJcbiAgICAgICAgaWYodGFiLnBhcmVudEVsZW1lbnQuY2hpbGROb2Rlcy5sZW5ndGggPT09IDEpIHJldHVybjtcclxuICAgICAgICAvLyBhbmltYXRpb25cclxuICAgICAgICB0YWIuY2xhc3NMaXN0LmFkZCgnZmFsbCcpO1xyXG4gICAgICAgIHJlbW92ZUxvY2FsVGFiKHRhYik7XHJcbiAgICAgICAgdGFiLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRhYi5yZW1vdmUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBjaGVjayBtYXJrXHJcblxyXG4gICAgaWYoaXRlbS5jbGFzc0xpc3RbMF0gPT09ICd0YWItZGl2JyB8fCBpdGVtLmNsYXNzTGlzdFswXSA9PT0gJ3RhYicgfHwgaXRlbS5jbGFzc0xpc3RbMF0gPT09ICdzcGFuLWRpdicpIHtcclxuICAgICAgICBsZXQgdGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhYicpO1xyXG4gICAgICAgIGlmKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3RhYicpKSB7XHJcbiAgICAgICAgICAgIHRhYi5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCd0YWItYWN0aXZlJykpO1xyXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3RhYi1hY3RpdmUnKTtcclxuICAgICAgICAgICAgY2xlYXJUb2RvcygpO1xyXG4gICAgICAgICAgICBnZXRUb2RvcygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNhdmVMb2NhbFRhYih0YWIpIHtcclxuICAgIC8vY2hlY2sgLS0gZG8gSSBhbHJlYWR5IGhhdmUgdGhpbmdzIGluIHRoZXJlP1xyXG4gICAgcmV0cmlldmVUYWJzRnJvbU1lbW9yeSgpO1xyXG4gICAgdGFicy5wdXNoKHRhYik7XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGFicycsIEpTT04uc3RyaW5naWZ5KHRhYnMpKTsgICBcclxufVxyXG5cclxuZnVuY3Rpb24gbG9hZFRhYnMoKSB7XHJcbiAgICByZXRyaWV2ZVRhYnNGcm9tTWVtb3J5KCk7XHJcbiAgICB0YWJzLmZvckVhY2goZnVuY3Rpb24odGFiKXtcclxuICAgICAgICBsZXQgbmFtZSA9IHRhYi5uYW1lO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBuZXdUYWIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgICAgIG5ld1RhYi5jbGFzc0xpc3QuYWRkKCd0YWInKTtcclxuICAgICAgICBsZXQgbmV3RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgbmV3RGl2LmNsYXNzTGlzdC5hZGQoJ3RhYi1kaXYnKTtcclxuICAgICAgICBsZXQgbmV3U3BhbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIG5ld1NwYW5EaXYuY2xhc3NMaXN0LmFkZCgnc3Bhbi1kaXYnKTtcclxuICAgICAgICBsZXQgbmV3U3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICBuZXdTcGFuLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIFxyXG4gICAgICAgIGxldCBuZXdUcmFzaGNhbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIG5ld1RyYXNoY2FuRGl2LmNsYXNzTGlzdC5hZGQoJ3RyYXNoY2FuLWRpdicpXHJcbiAgICAgICAgbGV0IG5ld1RyYXNoQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgICAgbmV3VHJhc2hCdXR0b24uY2xhc3NMaXN0LmFkZCgndHJhc2gtYnRuJyk7XHJcbiAgICAgICAgbmV3VHJhc2hCdXR0b24udGV4dENvbnRlbnQgPSAn8J+Xke+4jyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbmV3U3BhbkRpdi5hcHBlbmRDaGlsZChuZXdTcGFuKTtcclxuICAgICAgICBuZXdEaXYuYXBwZW5kQ2hpbGQobmV3U3BhbkRpdik7XHJcbiAgICAgICAgbmV3VHJhc2hjYW5EaXYuYXBwZW5kQ2hpbGQobmV3VHJhc2hCdXR0b24pO1xyXG4gICAgICAgIG5ld1RhYi5hcHBlbmRDaGlsZChuZXdEaXYpO1xyXG4gICAgICAgIG5ld1RhYi5hcHBlbmRDaGlsZChuZXdUcmFzaGNhbkRpdik7XHJcbiAgICAgICAgc2VsZWN0b3JzLnRhYkxpc3QuYXBwZW5kQ2hpbGQobmV3VGFiKTsgICBcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZUxvY2FsVGFiKHRhYikge1xyXG4gICAgcmV0cmlldmVUYWJzRnJvbU1lbW9yeSgpO1xyXG4gICAgLy8gd2hhdCBJIGNsaWNrIGlzIHRoZSBkaXYsIG5vdyBJIHdhbnQgdGhlIGxpIGFuZCB0aGUgaW5uZXIgdGV4dFxyXG4gICAgLy8gc28gd2UgY2FuIFNQTElDRSBpdFxyXG4gICAgY29uc3QgdGFiSW5kZXggPSB0YWIuY2hpbGRyZW5bMF0uaW5uZXJUZXh0O1xyXG4gICAgdGFicy5zcGxpY2UodGFicy5pbmRleE9mKHRhYkluZGV4KSwgMSk7XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGFicycsIEpTT04uc3RyaW5naWZ5KHRhYnMpKTtcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFjdGl2YXRlVGFiKCkge1xyXG4gICAgXHJcbiAgICBpZihzZWxlY3RvcnMudGFiTGlzdC5jaGlsZE5vZGVzWzBdID09PSB1bmRlZmluZWQpIHJldHVybjtcclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHNlbGVjdG9ycy50YWJMaXN0LmNoaWxkTm9kZXNbMF0uY2xhc3NMaXN0LmFkZCgndGFiLWFjdGl2ZScpOyAgICBcclxuICAgICAgICBnZXRUb2RvcygpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhclRvZG9zKCkge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZG8tbGlzdCcpLmlubmVyVGV4dCA9ICcnO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZXRyaWV2ZVRhYnNGcm9tTWVtb3J5KCkge1xyXG4gICAgaWYobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RhYnMnKSA9PT0gbnVsbCkgdGFicyA9IFtdO1xyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdGFicyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RhYnMnKSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGFicztcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VG9kYXlEYXRlKCkge1xyXG4gICAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKTtcclxuICAgIGxldCBkYXkgPSB0b2RheS5nZXREYXRlKCk7XHJcbiAgICBsZXQgbW9udGggPSB0b2RheS5nZXRNb250aCgpICsgMTtcclxuICAgIGlmKG1vbnRoIDwgMTApIHtcclxuICAgICAgICBtb250aCA9IGAwJHttb250aH1gO1xyXG4gICAgfSAgICAgICAgXHJcbiAgICBsZXQgeWVhciA9IHRvZGF5LmdldEZ1bGxZZWFyKCk7XHJcbiAgICBsZXQgdG9kYXlEYXRlID0gKGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fWApO1xyXG5cclxuICAgIGxldCBkYXRlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kby1kYXRlLWlucHV0Jyk7XHJcbiAgICBkYXRlSW5wdXQuc2V0QXR0cmlidXRlKCdtaW4nLCB0b2RheURhdGUpO1xyXG59Il0sIm5hbWVzIjpbIlRhYiIsIm5hbWUiLCJ0aGlzIiwidG9kb3MiLCJUb2RvIiwiZGF0ZSIsInByaW9yaXR5Iiwic3RhdHVzIiwidG9kb0lucHV0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidG9kb0RhdGVJbnB1dCIsInRvZG9Qcmlvcml0eUlucHV0IiwidG9kb0J1dHRvbiIsInRvZG9MaXN0IiwiZmlsdGVyT3B0aW9uIiwiYWRkVGFiQnV0dG9uIiwidGFiTGlzdCIsInRhYiIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0YWJzIiwiZ2V0VG9kb3MiLCJyZXRyaWV2ZVRhYnNGcm9tTWVtb3J5IiwidGFiTmFtZSIsImNoaWxkcmVuIiwiaW5uZXJUZXh0IiwiZm9yRWFjaCIsInRvZG8iLCJ0b2RvRGl2IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsIm5ld1RvZG8iLCJuZXdUb2RvTmFtZURpdiIsInRleHRDb250ZW50IiwibmV3VG9kb0RhdGVEaXYiLCJuZXdUb2RvUHJpb3JpdHlEaXYiLCJhcHBlbmRDaGlsZCIsImNvbXBsZXRlZEJ1dHRvbiIsInRyYXNoQnV0dG9uIiwiYWN0aXZhdGVUYWIiLCJ1bmRlZmluZWQiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiSlNPTiIsInBhcnNlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm5ld1RhYiIsIm5ld0RpdiIsIm5ld1NwYW5EaXYiLCJuZXdTcGFuIiwibmV3VHJhc2hjYW5EaXYiLCJuZXdUcmFzaEJ1dHRvbiIsInRvZGF5IiwiRGF0ZSIsImRheSIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwidG9kYXlEYXRlIiwiZ2V0RnVsbFllYXIiLCJzZXRBdHRyaWJ1dGUiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwibmV3dG9kb29iaiIsImNoaWxkTm9kZXMiLCJwdXNoIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInNhdmVUb2Rvc2luVGFiIiwiaXRlbSIsInRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJ0b2RvRm9yVGFiIiwiZmlsdGVyIiwicmVtb3ZlTG9jYWxUb2RvcyIsInJlbW92ZSIsInRvZ2dsZSIsInZhbHVlIiwic3R5bGUiLCJkaXNwbGF5IiwiY29udGFpbnMiLCJwcm9tcHQiLCJzYXZlTG9jYWxUYWIiLCJsZW5ndGgiLCJ0YWJJbmRleCIsInNwbGljZSIsImluZGV4T2YiLCJyZW1vdmVMb2NhbFRhYiJdLCJzb3VyY2VSb290IjoiIn0=